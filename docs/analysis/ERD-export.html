<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ERD - Pharmacy V15</title>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #f5f5f5;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 { color: #333; text-align: center; }
        .container { 
            background: white; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 1400px;
        }
        button {
            margin: 20px auto;
            padding: 15px 30px;
            font-size: 16px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: block;
        }
        button:hover { background: #45a049; }
        .instruction {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #2196F3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä ERD - S∆° ƒë·ªì Quan h·ªá Th·ª±c th·ªÉ</h1>
        <div class="instruction">
            <strong>H∆∞·ªõng d·∫´n l∆∞u PNG:</strong> Click chu·ªôt ph·∫£i v√†o s∆° ƒë·ªì ‚Üí "Save image as..." ‚Üí L∆∞u th√†nh <code>ERD-pharmacy-v15.png</code>
        </div>
        <div class="mermaid">
erDiagram
    categories ||--o{ medicines : "c√≥"
    medicines ||--o{ batches : "c√≥ nhi·ªÅu l√¥"
    batches ||--o{ inventory : "ph√¢n b·ªï"
    batches ||--o{ invoice_details : "ƒë∆∞·ª£c b√°n"
    branches ||--o{ inventory : "qu·∫£n l√Ω"
    branches ||--o{ pharmacists : "c√≥ nh√¢n vi√™n"
    branches ||--o{ invoices : "ph√°t sinh"
    pharmacists ||--o{ invoices : "t·∫°o"
    customers ||--o{ invoices : "mua"
    invoices ||--o{ invoice_details : "ch·ª©a"

    categories {
        INT category_id PK
        VARCHAR category_name
    }

    medicines {
        INT medicine_id PK
        INT category_id FK
        VARCHAR name
        VARCHAR brand
        VARCHAR base_unit "H·ªôp"
        VARCHAR sub_unit "Vi√™n"
        INT conversion_rate
        DECIMAL base_sell_price
        DECIMAL sub_sell_price
        INT min_stock_level
        TIMESTAMP created_at
    }

    batches {
        INT batch_id PK
        INT medicine_id FK
        VARCHAR batch_number
        DATE manufacturing_date
        DATE expiry_date
        DECIMAL import_price_package
        INT initial_quantity
        INT current_total_quantity
        TIMESTAMP import_date
    }

    branches {
        INT branch_id PK
        VARCHAR branch_name
        VARCHAR address
        VARCHAR phone_number
    }

    inventory {
        INT inventory_id PK
        INT branch_id FK
        INT batch_id FK
        INT quantity_std
        TIMESTAMP last_updated
    }

    pharmacists {
        INT pharmacist_id PK
        INT branch_id FK
        VARCHAR username UK
        VARCHAR password
        VARCHAR full_name
        VARCHAR role "ADMIN/STAFF"
    }

    customers {
        INT customer_id PK
        VARCHAR phone_number UK
        VARCHAR customer_name
        INT points
    }

    invoices {
        INT invoice_id PK
        TIMESTAMP invoice_date
        INT branch_id FK
        INT pharmacist_id FK
        INT customer_id FK
        DECIMAL total_amount
        BOOLEAN is_simulated
    }

    invoice_details {
        INT detail_id PK
        INT invoice_id FK
        INT batch_id FK
        ENUM unit_sold "H·ªôp/Vi√™n"
        INT quantity_sold
        DECIMAL unit_price
        INT total_std_quantity
    }
        </div>
    </div>
</body>
</html>